!function(t){function r(t){return t=decodeURIComponent(t),t=t.replace("+"," ")}function e(t){var r=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],i=r.exec(t||""),o={};return e.forEach(function(t,r){o[t]=i[r]||""}),o}function i(t){var r,e,i,o,s,n,h=[];if("undefined"==typeof t||null===t||""===t)return h;for(0===t.indexOf("?")&&(t=t.substring(1)),e=t.toString().split(/[&;]/),r=0;r<e.length;r++)i=e[r],o=i.split("="),s=o[0],n=-1===i.indexOf("=")?null:null===o[1]?"":o[1],h.push([s,n]);return h}function o(t){this.uriParts=e(t),this.queryPairs=i(this.uriParts.query),this.hasAuthorityPrefixUserPref=null}Array.prototype.forEach||(Array.prototype.forEach=function(t,r){for(var e=0,i=this.length;i>e;++e)t.call(r||this,this[e],e,this)}),["protocol","userInfo","host","port","path","anchor"].forEach(function(t){o.prototype[t]=function(r){return"undefined"!=typeof r&&(this.uriParts[t]=r),this.uriParts[t]}}),o.prototype.hasAuthorityPrefix=function(t){return"undefined"!=typeof t&&(this.hasAuthorityPrefixUserPref=t),null===this.hasAuthorityPrefixUserPref?-1!==this.uriParts.source.indexOf("//"):this.hasAuthorityPrefixUserPref},o.prototype.query=function(t){var r,e,o="";for("undefined"!=typeof t&&(this.queryPairs=i(t)),r=0;r<this.queryPairs.length;r++)e=this.queryPairs[r],o.length>0&&(o+="&"),null===e[1]?o+=e[0]:(o+=e[0],o+="=",e[1]&&(o+=encodeURIComponent(e[1])));return o.length>0?"?"+o:o},o.prototype.getQueryParamValue=function(t){var e,i;for(i=0;i<this.queryPairs.length;i++)if(e=this.queryPairs[i],r(t)===r(e[0]))return e[1]},o.prototype.getQueryParamValues=function(t){var e,i,o=[];for(e=0;e<this.queryPairs.length;e++)i=this.queryPairs[e],r(t)===r(i[0])&&o.push(i[1]);return o},o.prototype.deleteQueryParam=function(t,e){var i,o,s,n,h=[];for(i=0;i<this.queryPairs.length;i++)o=this.queryPairs[i],s=r(o[0])===r(t),n=r(o[1])===r(e),(1===arguments.length&&!s||2===arguments.length&&!s&&!n)&&h.push(o);return this.queryPairs=h,this},o.prototype.addQueryParam=function(t,r,e){return 3===arguments.length&&-1!==e?(e=Math.min(e,this.queryPairs.length),this.queryPairs.splice(e,0,[t,r])):arguments.length>0&&this.queryPairs.push([t,r]),this},o.prototype.replaceQueryParam=function(t,e,i){var o,s,n=-1;if(3===arguments.length){for(o=0;o<this.queryPairs.length;o++)if(s=this.queryPairs[o],r(s[0])===r(t)&&decodeURIComponent(s[1])===r(i)){n=o;break}this.deleteQueryParam(t,i).addQueryParam(t,e,n)}else{for(o=0;o<this.queryPairs.length;o++)if(s=this.queryPairs[o],r(s[0])===r(t)){n=o;break}this.deleteQueryParam(t),this.addQueryParam(t,e,n)}return this},["protocol","hasAuthorityPrefix","userInfo","host","port","path","query","anchor"].forEach(function(t){var r="set"+t.charAt(0).toUpperCase()+t.slice(1);o.prototype[r]=function(r){return this[t](r),this}}),o.prototype.scheme=function(){var t="";return this.protocol()?(t+=this.protocol(),this.protocol().indexOf(":")!==this.protocol().length-1&&(t+=":"),t+="//"):this.hasAuthorityPrefix()&&this.host()&&(t+="//"),t},o.prototype.origin=function(){var t=this.scheme();return this.userInfo()&&this.host()&&(t+=this.userInfo(),this.userInfo().indexOf("@")!==this.userInfo().length-1&&(t+="@")),this.host()&&(t+=this.host(),this.port()&&(t+=":"+this.port())),t},o.prototype.toString=function(){var t=this.origin();return this.path()?t+=this.path():this.host()&&(this.query().toString()||this.anchor())&&(t+="/"),this.query().toString()&&(0!==this.query().toString().indexOf("?")&&(t+="?"),t+=this.query().toString()),this.anchor()&&(0!==this.anchor().indexOf("#")&&(t+="#"),t+=this.anchor()),t},o.prototype.clone=function(){return new o(this.toString())},"undefined"==typeof module?t.Uri=o:module.exports=o}(this);